<!DOCTYPE html>
<html>
<head>
<title>Transit Trails</title>
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css" />
<link rel="stylesheet" href="vizstyle.css" />
<link rel="stylesheet" href="Control.Loading.css" />
<link href='http://fonts.googleapis.com/css?family=Alef' rel='stylesheet' type='text/css'>
<script src="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.js"></script>
<script src="map.js"></script>
<script src="data.js"></script>
<script src="Control.Loading.js"></script>
<link rel="stylesheet" type="text/css" href="jquery-ui.css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script> 
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js" type="text/javascript"></script>
</head>

<body>

<div class= "controls">
<img src = "Ttrails.png" align=center style = " height:5em; vertical-align:middle;">
<p>Have you ever wondered how much busses in the Puget Sound are deviate from their schedule overall? When you use apps like OneBusAway, that uses data from individual vehicles occasionally checking in - and that's what we're showing. The map below shows points; each point is an <em>average deviation from schedule</em> of all the busses that have checked-in at that point.</p>


<div class="explain">
<p><strong>Select a time and a day, such as: "rush hour on a typical weekday."</strong> Weekday, saturday, and sunday schedules - and deviations - are different, so you can use the day selector to switch between available days. Furthermore, deviation differs during rush hour relative to middle of the day. Use the time slider - make sure to click "Set Time" to update the data shown - to filter to a specific time interval during the selected day.</p>

<p>By selecting different days, and different times, you can explore the data to get a sense for the impact of the changes that bus routes went through over multiple months.</p>
</div>
<div  class="explain">
<p><strong>Get a sense for overall bus deviation from the schedule.</strong> When busses are too late - or too early - it is a nuisance to drivers and riders alike. Each dot is colored in accordance with how much a bus deviates:</p>

<div class="ok">Green dot: busses are on average within a minute of its schedule</div>
<div class="medium">Light red dot: busses are on average experiencing a typical delay of 2-5 minutes</div>
<div class="bad">Dark red dot: busses are on average more than 5 minutes delayed</div>

<p>You can <strong>click on every point</strong> to get the average deviation in seconds!</p>
</div>
<div class="explain">
<p><strong>Notice how noisy the data are.</strong> When we set out to make a visualization that shows the impact of route cuts and changes to schedule deviation, we didnâ€™t realize how noisy and unreliable data are! Notice all the gaps, all the check-ins that are close but not overlapping - you can <strong>zoom in using the scroll wheel of the mouse</strong> - and take these data with a grain of salt.</p>
</div>
<div class="container">
	<div align = "center">
   <b>December 2011: </b> <input type="radio" id="dayA1" name="dayA" onclick="changeDay(1,0)" checked><label for="radio1">Friday</label>
    <input type="radio" id="dayA2" name="dayA" onclick="changeDay(1,1)"><label for="radio2">Saturday</label>
    <input type="radio" id="dayA2" name="dayA" onclick="changeDay(1,2)"><label for="radio2">Sunday</label><br>
   
   <b>March 2012: &nbsp &nbsp &nbsp</b> <input type="radio" id="dayA3" name="dayA" onclick="changeDay(1,3)"><label for="radio3">Friday</label>
    <input type="radio" id="dayA4" name="dayA" onclick="changeDay(1,4)"><label for="radio4">Saturday</label>
    <input type="radio" id="dayA5" name="dayA" onclick="changeDay(1,5)"><label for="radio5">Sunday</label>
 
	</div>
	<div id="map1"><script>initializeMap(1, 1);</script></div>
	<br>
	<div class="slider_container" id = "slider1">
	<div class = "slider_labels">
		<div id = "left_label">Start time: <div id = "startTime" style="color: red; font-size: 14pt;"></div></div>
		<div id = "right_label">End time: <div id="endTime" style="color: red; font-size: 14pt;"></div></div>
		<br><br>
		<div id="slider-range"></div>
	</div>
	<button type="button" style="float:right;" onclick="filterByTime(parseInt(hours0), parseInt(minutes0), parseInt(hours1), parseInt(minutes1), 1);">Set Time</button>
	</div>
	
	
</div>


<div id="explain" align="center"> Select the time interval for which you wish to see bus locations. Drag the left handle to set the beginning of the time interval. <br>Drag the right handle to set the end of the interval. Click "Set Time" to redraw points from that time period. Times are in 24-hour time PST.
	
	<!--A natural language explanation goes here.
		If pre/post: "the weather on these two Mondays is similar. There was 0.03 more precipitation in March (going from .13 to .16) and it was 5 degrees warmer (going from 40 to45) but here were no outstanding adverse conditions. -->
	</div><br>

</div>

<script type="text/javascript">
	var minutes0 = 0,
		minutes1 = 0,
		hours0 = 9,
		hours1 = 17;
  $(function() {
    $( "#dayA" ).buttonset();
  });
  $(function() {
    $( "#dayB" ).buttonset();
  });
	$("#slider-range").slider({
		range: true,
		min: 0,
		max: 1435,
		values: [540, 1020],
		step:5,
		slide: slideTime
	});
	
	function slideTime(event, ui){
    var val0 = $("#slider-range").slider("values", 0),
        val1 = $("#slider-range").slider("values", 1);
        
    minutes0 = parseInt(val0 % 60, 10);
    hours0 = parseInt(val0 / 60 % 24, 10);
    minutes1 = parseInt(val1 % 60, 10);
    hours1 = parseInt(val1 / 60 % 24, 10);
        
    if (minutes0 < 10)
    	minutes0 = '0'.concat(minutes0);
    if (minutes1 < 10)
    	minutes1 = '0'.concat(minutes1);
    $("#startTime").text(hours0 + ":" + minutes0);
	$("#endTime").text(hours1 + ":" + minutes1);
	
}
slideTime();

</script>
</body>
</html>